webpackJsonp([25],{Ilf3:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("Xxa5"),s=i.n(a),n=(i("eqfM"),i("/QYm")),r=i("vqxw");function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function a(s,n){try{var r=t[s](n),o=r.value}catch(e){return void i(e)}if(!r.done)return Promise.resolve(o).then(function(e){a("next",e)},function(e){a("throw",e)});e(o)}("next")})}}var l={name:"MyBrand",inject:["reload"],data:function(){return{btnDis:!1,form:{attribues:"",attribuesItem:"",getItem:"",specification:"",specification1:"",price:""},value:[],categoryName:"",serverList:r.a,getList:[],qiniuData:{key:"",token:"0tJG2oh5JnpsneBzCn3CnP4N1bH3HZgn6HJoHQAt:yuA83mJmMRtMHE53vBPuTr8kZcw=:eyJzY29wZSI6InF1eXV5aWltYWdlIiwiZGVhZGxpbmUiOjMxNzM1MDA1ODV9"},upload_qiniu_url:"http://upload-z2.qiniup.com",upload_qiniu_addr:"http://image.quyuyi.com",imageUrl:"",currentdate:"",dialogImageUrl1:"",dialogVisible1:!1,imgUrl1:[],actionUrl:"",uploadUrl:this.GLOBAL.imgApi.replace(/\'/g,""),dialogImageUrl2:"",dialogVisible2:!1,imgUrl2:[],showBtn:!1,showInput:!1,showText:!1,inputDis:!1,loading:!1,showBtn1:!1,items:[],showText1:!1,showBtn2:!1,sheradio:1,sheradioValue:!0,value1:"",delMethod:1,setTime:"",speciName:[],specifications:[],specName:{name:"",content:""},tableData:[],attItems:[],attTitle:"",spec:[],idempotency:"",classifica:[],userInfo:{}}},methods:{handleChange:function(e){var t=this.$refs.getOptions.getCheckedNodes()[0].pathLabels;this.classifica=t.toString().replace(/,/g,"_"),this.categoryName=e.toString(),this.categoryName=this.categoryName.replace(/,/g,"_")},beforeUpload1:function(e){this.qiniuData.key=this.currentdate+"_"+e.name;var t="image/jpeg"===e.type,i="image/png"===e.type,a=e.size/1024/1024<2;return t||i?a?void 0:(this.$message({type:"error",message:"图片大小不能超过 2MB!",offset:80}),!1):(this.$message({type:"error",message:"图片只能是 JPG/PNG 格式!",offset:80}),!1)},handleRemove1:function(e,t){},handlePictureCardPreview1:function(e){this.dialogImageUrl1=e.url,this.dialogVisible1=!0},handleError1:function(){this.$message({message:"上传失败",duration:2e3,type:"warning",offset:80})},success1:function(e,t,i){this.imageUrl1=this.upload_qiniu_addr+e.key,this.fileLists=[],this.fileLists=[t],this.imgUrl1.push(this.upload_qiniu_addr+"/"+e.key),this.getTime()},beforeUpload2:function(e){this.qiniuData.key=this.currentdate+"_"+e.name;var t="image/jpeg"===e.type,i="image/png"===e.type,a=e.size/1024/1024<2;return t||i?a?void 0:(this.$message({type:"error",message:"图片大小不能超过 2MB!",offset:80}),!1):(this.$message({type:"error",message:"图片只能是 JPG/PNG 格式!",offset:80}),!1)},handleRemove2:function(e,t){},handlePictureCardPreview2:function(e){this.dialogImageUrl2=e.url,this.dialogVisible2=!0},success2:function(e,t,i){this.imageUrl2=this.upload_qiniu_addr+e.key,this.fileLists=[],this.fileLists=[t],this.imgUrl2.push(this.upload_qiniu_addr+"/"+e.key),this.getTime()},handleError2:function(){this.$message({message:"上传失败",duration:2e3,type:"warning",offset:80})},attFocus:function(){this.showBtn=!0},addAttr1:function(){if(""==this.form.attribues||null==this.form.attribues)return this.$message({message:"属性名称不能为空",type:"warning"}),!1;this.attTitle=this.form.attribues,this.attItems.push({name:this.attTitle,content:""})},attDel:function(e){this.attItems.splice(e,1)},attblur:function(e){},attFocus1:function(){this.showBtn1=!0},init:function(){var e,t,i=(e=this.spec,t=[],e.forEach(function(e){if(0===t.length)t=e;else{var i=[];t.forEach(function(t){e.forEach(function(e){t instanceof Array?i.push([].concat(function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}(t),[e])):i.push([t,e])})}),t=i}}),t);this.tableData=[];for(var a=0;a<i.length;a++){var s={},n="";n=i[a]instanceof Array?i[a].join("_"):i[a],s.content=n,s.price="",s.stock="",this.tableData.push(s)}},addAttr3:function(){if(""==this.form.specification||null==this.form.specification)return this.$message({message:"属性名称不能为空",type:"warning"}),!1;this.showBtn2=!0,this.speciName=this.form.specification,this.form.specification="";var e=[];e.push({name:this.speciName,content:[]}),this.items.push(e),this.spec.push([])},addsss:function(e,t,i,a){var s=a+t+"key::"+e[t].name,n=document.getElementById(s).value;if(""==n||null==n)return this.$message({message:"属性名称不能为空",type:"warning"}),!1;e[t].content.push(n),this.spec[a].push(n),this.paramValue={},this.showText1=!0,document.getElementById(s).value="",this.init()},delsss:function(e,t){this.items.splice(e,1),this.items.length<=0?this.showBtn2=!1:this.showBtn2=!0,this.spec.splice(t,1),this.init()},delAttInfosss:function(e,t){var i=this;this.$confirm("确定要删除此项？, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){i.items[e][0].content.splice(t,1),i.spec[e].splice(t,1),i.init(),i.$message({type:"success",message:"删除成功!"})}).catch(function(){i.$message({type:"info",message:"已取消删除"})})},changeSheradio:function(e){},empotency:function(){var e=this;return o(s.a.mark(function t(){var i;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$Http.empotency();case 2:0===(i=t.sent).code?(n.a.clear(),e.idempotency=i.data,localStorage.removeItem("idempotency"),localStorage.setItem("idempotency",e.idempotency)):n.a.clear();case 4:case"end":return t.stop()}},t,e)}))()},release:function(){var e=this;return o(s.a.mark(function t(){var i;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(""!=e.form.name&&null!=e.form.name){t.next=5;break}return e.$message({type:"warning",message:"商品标题不能为空",offset:80}),t.abrupt("return",!1);case 5:if(""!=e.form.alias&&null!=e.form.alias){t.next=10;break}return e.$message({type:"warning",message:"商品副标题不能为空",offset:80}),t.abrupt("return",!1);case 10:if(""!=e.categoryName){t.next=15;break}return e.$message({type:"warning",message:"商品分类不能为空",offset:80}),t.abrupt("return",!1);case 15:if(""!=e.form.price){t.next=20;break}return e.$message({type:"warning",message:"商品价格不能为空",offset:80}),t.abrupt("return",!1);case 20:if(0!==e.tableData.length){t.next=25;break}return e.$message({type:"warning",message:"规格不能为空",offset:80}),t.abrupt("return",!1);case 25:if(i={title:e.form.name,subTitle:e.form.alias,storeId:localStorage.getItem("id"),cid:e.categoryName,categoryName:e.classifica,images:JSON.stringify(e.imgUrl1),price:e.form.price.toString(),attributes:JSON.stringify(e.attItems),parameters:JSON.stringify(e.tableData),saleable:e.sheradio,distribution:e.delMethod,description:JSON.stringify(e.imgUrl2),storePhone:localStorage.getItem("storePhone"),storeLogo:localStorage.getItem("logo")},null!=e.userInfo&&""!=e.userInfo){t.next=31;break}e.btnDis=!1,e.$message({type:"error",message:"店铺未认证",offset:80}),t.next=39;break;case 31:if(2!=e.userInfo.states){t.next=37;break}return t.next=34,e.$Http.relase(i,!1,{headers:{requestNo:localStorage.getItem("idempotency")}}).then(function(t){0===t.code&&(e.btnDis=!0,setTimeout(function(){e.$message({message:"添加成功",type:"success",offset:80}),e.reload()},1500))});case 34:t.sent,t.next=39;break;case 37:e.btnDis=!1,e.$message({type:"error",message:"店铺未认证",offset:80});case 39:case"end":return t.stop()}},t,e)}))()},getStoreInfo:function(){var e=this;return o(s.a.mark(function t(){var i,a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i={uid:localStorage.getItem("uid")},t.next=3,e.$Http.getStoreInfo(i);case 3:a=t.sent,e.userInfo=a.data;case 5:case"end":return t.stop()}},t,e)}))()},getTime:function(){var e=new Date,t=e.getMonth()+1,i=e.getDate();t>=1&&t<=9&&(t="0"+t),i>=0&&i<=9&&(i="0"+i),this.currentdate=e.getFullYear()+"-"+t+"-"+i+"_"+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds();e.getFullYear()}},created:function(){this.getList=this.serverList,this.empotency(),this.getStoreInfo(),this.getTime()}},c={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-container",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{fluid:"","grid-list-md":"","element-loading-text":"删除中","element-loading-spinner":"el-icon-loading"}},[i("div",{staticClass:"commodity-list"},[i("el-form",{ref:"form",staticClass:"forms",attrs:{model:e.form,"label-width":"110px"}},[i("h3",[e._v("基本信息")]),e._v(" "),i("el-form-item",{attrs:{label:"商品标题"}},[i("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"副标题"}},[i("el-input",{model:{value:e.form.alias,callback:function(t){e.$set(e.form,"alias",t)},expression:"form.alias"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"商品分类"}},[i("el-cascader",{ref:"getOptions",attrs:{options:e.getList.classiFication},on:{change:e.handleChange},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"商品主图"}},[i("el-upload",{attrs:{action:e.upload_qiniu_url,"list-type":"picture-card",limit:5,data:e.qiniuData,"before-upload":e.beforeUpload1,"on-preview":e.handlePictureCardPreview1,"on-success":e.success1,"on-error":e.handleError1,"on-remove":e.handleRemove1}},[i("i",{staticClass:"el-icon-plus"})]),e._v(" "),i("el-dialog",{attrs:{visible:e.dialogVisible1,width:"400px"},on:{"update:visible":function(t){e.dialogVisible1=t}}},[i("img",{attrs:{width:"100%",src:e.dialogImageUrl1,alt:""}})]),e._v(" "),i("p",{staticClass:"suggest"},[e._v("建议尺寸: 690*690像素(商品主图限制5张)")])],1),e._v(" "),i("el-form-item",{attrs:{label:"价格 (必填)"}},[i("el-input",{attrs:{oninput:"value=value.replace(/[^\\d.]/g,'')"},model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"属性"}},[i("el-input",{attrs:{disabled:e.inputDis},on:{focus:e.attFocus},model:{value:e.form.attribues,callback:function(t){e.$set(e.form,"attribues",t)},expression:"form.attribues"}}),e._v(" "),i("el-button",{directives:[{name:"show",rawName:"v-show",value:e.showBtn,expression:"showBtn"}],on:{click:e.addAttr1}},[e._v("添加属性")])],1),e._v(" "),e._l(e.attItems,function(t,a){return i("el-form-item",{key:t.index,attrs:{label:e.attItems[a].name}},[i("el-input",{on:{blur:function(t){return e.attblur(e.attItems)}},model:{value:e.attItems[a].content,callback:function(t){e.$set(e.attItems[a],"content",t)},expression:"attItems[index].content"}}),e._v(" "),i("el-button",{on:{click:function(t){return e.attDel(a)}}},[e._v("删除属性")])],1)}),e._v(" "),i("el-form-item",{attrs:{label:"规格"}},[i("el-input",{on:{focus:e.attFocus1},model:{value:e.form.specification,callback:function(t){e.$set(e.form,"specification",t)},expression:"form.specification"}}),e._v(" "),i("el-button",{directives:[{name:"show",rawName:"v-show",value:e.showBtn1,expression:"showBtn1"}],on:{click:e.addAttr3}},[e._v("添加属性")])],1),e._v(" "),e._l(e.items,function(t,a){return i("div",{key:t.index},e._l(t,function(s,n){return i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.showBtn2,expression:"showBtn2"}],key:n,attrs:{label:t[n].name}},[i("input",{staticStyle:{width:"330px",border:"1px solid #DCDFE6","border-radius":"4px","padding-left":"14px"},attrs:{id:a+n+"key::"+t[n].name}}),e._v(" "),i("el-button",{on:{click:function(i){return e.addsss(t,n,e.items,a)}}},[e._v("添加属性")]),e._v(" "),i("el-button",{on:{click:function(t){return e.delsss(a,n)}}},[e._v("删除属性")])],1)}),1)}),e._v(" "),e._l(e.items,function(t,a){return i("div",{directives:[{name:"show",rawName:"v-show",value:e.showText1,expression:"showText1"}],key:t.index,staticClass:"attInfo"},e._l(t,function(s,n){return i("ul",{key:t.j},e._l(s.content,function(t,n){return i("li",{key:n,staticStyle:{"line-height":"28px"}},[e._v("\n              "+e._s(s.name)+" :\n                "+e._s(t)+" "),i("i",{staticClass:"el-icon-delete",staticStyle:{cursor:"pointer",color:"red"},on:{click:function(t){return e.delAttInfosss(a,n)}}}),e._v(" "),i("br")])}),0)}),0)}),e._v(" "),i("div",{staticStyle:{width:"800px","margin-left":"24px"}},[i("el-table",{attrs:{data:e.tableData}},[i("el-table-column",{attrs:{prop:"content",label:"规格",width:"200"}}),e._v(" "),i("el-table-column",{attrs:{label:"价格",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-input",{staticStyle:{width:"120px"},model:{value:t.row.price,callback:function(i){e.$set(t.row,"price",i)},expression:"scope.row.price"}})]}}])})],1)],1),e._v(" "),i("h3",[e._v("商品信息")]),e._v(" "),i("el-form-item",{staticClass:"shelves",staticStyle:{"z-index":"99999"},attrs:{label:"上架时间"}},[i("el-radio-group",{on:{change:e.changeSheradio},model:{value:e.sheradio,callback:function(t){e.sheradio=t},expression:"sheradio"}},[i("el-radio",{attrs:{label:1}},[e._v("立即上架")]),e._v(" "),i("el-radio",{attrs:{label:2}},[e._v("放入仓库")]),e._v(" "),i("el-radio",{attrs:{label:3}},[e._v("下架")])],1)],1),e._v(" "),i("el-form-item",{staticClass:"delivery",attrs:{label:"配送方式"}},[i("el-radio-group",{model:{value:e.delMethod,callback:function(t){e.delMethod=t},expression:"delMethod"}},[i("el-radio",{attrs:{label:1}},[e._v("无需发货商品，在线电子发票")]),e._v(" "),i("el-radio",{attrs:{label:2}},[e._v("快递发货")])],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"商品展示图"}},[i("el-upload",{attrs:{action:e.upload_qiniu_url,data:e.qiniuData,"list-type":"picture-card","before-upload":e.beforeUpload2,"on-success":e.success2,"on-error":e.handleError2,"on-preview":e.handlePictureCardPreview2,"on-remove":e.handleRemove2}},[i("i",{staticClass:"el-icon-plus"})]),e._v(" "),i("el-dialog",{attrs:{visible:e.dialogVisible2,width:"400px"},on:{"update:visible":function(t){e.dialogVisible2=t}}},[i("img",{attrs:{width:"100%",src:e.dialogImageUrl2,alt:""}})]),e._v(" "),i("p",{staticClass:"suggest"},[e._v("建议尺寸: 750*750像素")]),e._v(" "),i("el-button",{staticClass:"post-an-item",attrs:{type:"primary",disabled:e.btnDis},on:{click:e.release}},[e._v("发布商品")])],1)],2)],1)])},staticRenderFns:[]};var u=i("VU/8")(l,c,!1,function(e){i("fOiE")},"data-v-3287de6b",null);t.default=u.exports},fOiE:function(e,t){}});
//# sourceMappingURL=25.ee64105a76c34a14e9cb.js.map