webpackJsonp([28],{"4wcr":function(e,t){},gZbA:function(e,t){},vXi7:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("7+uW"),d={name:"tree-item",props:{model:Object,url:String,isEdit:{type:Boolean,default:!1},nodes:Object,parentState:Boolean},created:function(){},data:function(){return{c1:"",c2:"",c3:"",isSelected:!1,open:!1,beginEdit:!1}},watch:{parentState:function(e){e||(this.open=e)}},computed:{isFolder:function(){return this.model.children&&this.model.children.length>0}},methods:{toggle:function(){var e=this;this.nodes.selected.isSelected=!1,this.isSelected=!0,this.nodes.selected=this,this.handleClick(this.model),0==this.model.parentId&&(this.nodes.opened&&this!=this.nodes.opened&&(this.nodes.opened.open=!1),this.nodes.opened=this),this.open=!this.open,this.model.isParent&&!this.isFolder&&this.open&&this.$http.get(this.url,{params:{pid:this.model.id}}).then(function(t){i.default.set(e.model,"children",t.data),e.model.children.forEach(function(t){t.path=[],e.model.path.forEach(function(e){return t.path.push(e)}),t.path.push(t.name)})}).catch(function(e){console.log(e)})},addChild:function(){var e=this;this.$http.get(this.url,{params:{pid:-1}}).then(function(t){var n={id:t.data[0].id+1,name:"新的节点",parentId:e.model.id,isParent:!1,sort:e.model.children?e.model.children.length+1:1};e.isSelected?e.model.isParent?e.isFolder?(e.model.children.push(n),e.open=!0,e.handleAdd(n)):e.$http.get(e.url,{params:{pid:e.model.id}}).then(function(t){i.default.set(e.model,"children",t.data),e.model.children.push(n),e.open=!0,e.handleAdd(n)}):(i.default.set(e.model,"children",[n]),e.model.isParent=!0,e.open=!0,e.handleAdd(n)):e.$message.error("选中后再操作！")})},deleteChild:function(){var e=this;this.$message.confirm("此操作将永久删除数据，是否继续?","提示",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning"}).then(function(){e.handleDelete(e.model.id)}).catch(function(){e.$message.info("已取消删除")})},editChild:function(){var e=this;this.beginEdit=!0,this.$nextTick(function(){return e.$refs[e.model.id].focus()})},afterEdit:function(){this.beginEdit&&(this.beginEdit=!1,this.handleEdit(this.model.id,this.model.name))},handleAdd:function(e){this.$emit("handleAdd",e)},handleDelete:function(e){this.$emit("handleDelete",e)},handleEdit:function(e,t){this.$emit("handleEdit",e,t)},handleClick:function(e){this.$emit("handleClick",e)}}},o={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-list-tile",{staticClass:"level1 pt-0 pb-0 mt-0 mb-0",class:{selected:e.isSelected},on:{click:e.toggle}},[n("v-list-tile-avatar",[e.model.isParent?n("v-icon",[e._v(e._s(e.open?"folder_open":"folder"))]):e._e(),e._v(" "),e.model.isParent?e._e():n("v-icon",[e._v("insert_drive_file")])],1),e._v(" "),n("v-list-tile-content",[n("v-list-tile-title",{directives:[{name:"show",rawName:"v-show",value:!e.beginEdit,expression:"!beginEdit"}]},[n("span",[e._v(e._s(e.model.name))])]),e._v(" "),n("input",{directives:[{name:"show",rawName:"v-show",value:e.beginEdit,expression:"beginEdit"},{name:"model",rawName:"v-model",value:e.model.name,expression:"model.name"}],ref:e.model.id,domProps:{value:e.model.name},on:{click:function(e){e.stopPropagation()},blur:e.afterEdit,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.afterEdit(t)},input:function(t){t.target.composing||e.$set(e.model,"name",t.target.value)}}})],1),e._v(" "),e.isEdit?n("v-list-tile-action",[n("v-btn",{attrs:{icon:"",color:e.c1},on:{mouseover:function(t){e.c1="primary"},mouseout:function(t){e.c1=""},click:function(t){return t.stopPropagation(),e.addChild(t)}}},[n("i",{staticClass:"el-icon-plus"})])],1):e._e(),e._v(" "),e.isEdit?n("v-list-tile-action",[n("v-btn",{attrs:{icon:"",color:e.c2},on:{mouseover:function(t){e.c2="success"},mouseout:function(t){e.c2=""},click:function(t){return t.stopPropagation(),e.editChild(t)}}},[n("i",{staticClass:"el-icon-edit"})])],1):e._e(),e._v(" "),e.isEdit?n("v-list-tile-action",[n("v-btn",{attrs:{icon:"",color:e.c3},on:{mouseover:function(t){e.c3="error"},mouseout:function(t){e.c3=""},click:function(t){return t.stopPropagation(),e.deleteChild(t)}}},[n("i",{staticClass:"el-icon-delete"})])],1):e._e()],1),e._v(" "),e.isFolder?n("v-list",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"ml-4 pt-0 pb-0",attrs:{dense:"",transition:"scale-transition"}},e._l(e.model.children,function(t,i){return n("tree-item",{key:i,staticClass:"item",attrs:{model:t,url:e.url,isEdit:e.isEdit,nodes:e.nodes,parentState:e.open},on:{handleAdd:e.handleAdd,handleEdit:e.handleEdit,handleDelete:e.handleDelete,handleClick:e.handleClick}})}),1):e._e()],1)},staticRenderFns:[]};var l=n("VU/8")(d,o,!1,function(e){n("4wcr")},"data-v-0a85b683",null).exports,s={name:"vTree",props:{url:String,isEdit:{type:Boolean,default:!1},treeData:{type:Array}},data:function(){return{db:[],nodes:{opened:null,selected:{isSelected:!1}}}},components:{TreeItem:l},created:function(){var e=this;this.treeData&&this.treeData.length>0?this.db=this.treeData:this.verify().then(function(){e.getData()}).catch(function(){e.$router.push("/login")})},methods:{getData:function(){var e=this;this.$http.get(this.url,{params:{pid:0}}).then(function(t){e.db=t.data,e.db.forEach(function(e){return e.path=[e.name]})})},handleAdd:function(e){this.$emit("handleAdd",this.copyNodeInfo(e))},handleEdit:function(e,t){this.$emit("handleEdit",e,t)},handleDelete:function(e){this.deleteById(e,this.db),this.$emit("handleDelete",e)},handleClick:function(e){this.$emit("handleClick",this.copyNodeInfo(e))},deleteById:function(e,t){var n=t||this.db;for(var i in n){var d=n[i];if(d.id===e)return void n.splice(i,1);d.children&&d.children.length>0&&this.deleteById(e,d.children)}},copyNodeInfo:function(e){var t={};for(var n in e)t[n]=e[n];return t}},watch:{}},a={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-list",{staticClass:"pt-0 pb-0",attrs:{dense:""}},e._l(e.db,function(t,i){return n("TreeItem",{key:i,staticClass:"item",attrs:{model:t,url:e.url,isEdit:e.isEdit,nodes:e.nodes},on:{handleAdd:e.handleAdd,handleEdit:e.handleEdit,handleDelete:e.handleDelete,handleClick:e.handleClick}})}),1)},staticRenderFns:[]};var r=n("VU/8")(s,a,!1,function(e){n("gZbA")},"data-v-af5b82d6",null);t.default=r.exports}});
//# sourceMappingURL=28.faaa4ff6439378ba5883.js.map